prompt: |
  Cross-Regional Financing Risk Assessment (find exactly 5 models with the lowest risk)

  Files (JSON, read-only):
    /workdir/data/cars.json              # key: cars
    /workdir/data/dealers.json           # key: dealers
    /workdir/data/financing_incentives.json  # key: financing_offers

  Eligibility (all must hold at model level):
    • avg_price ≥ 40000        (average of car.price for that make+model+year)
    • safety_rating ≥ 4
    • mpg_combined ≥ 25
    • ≥ 3 dealers with: customer_satisfaction ≥ 0.75 AND (qty_in_stock + qty_in_transit) > 0

  Risk components (compute exactly):
    1) depreciation_risk = depreciation_rate × multiplier
       multipliers (case-insensitive):
         luxury=1.5, ultra_luxury=1.5, premium=1.3, mainstream=1.0,
         economy=0.8, specialty=1.2, value=0.9, performance=1.4, family=0.95
    2) financing_exposure:
       max_apr = max apr among financing_offers where make matches AND
                 (model matches OR "all_luxury_models" appears in applicable_models).
       If no such offer, max_apr = 8.5. Baseline=3.5.
       financing_exposure = max(0, max_apr − 3.5).
    3) market_volatility:
       inv_counts = (qty_in_stock + qty_in_transit) across qualifying dealers for the model.
       If len(inv_counts) ≤ 1 → 2.0. Else let mean=avg(inv_counts); if mean==0 → 2.5; 
       otherwise market_volatility = population_variance(inv_counts)/mean.     # divide by n
    4) inventory_liquidity_risk:
       turnover_days_list = dealer.inventory_turnover_days for each qualifying dealer encountered.
       Replace 0 with 30. inventory_liquidity_risk = average(turnover_days_list)/45.0.

  Total risk:
    total_risk_score = 2.0*depreciation_risk + 0.8*financing_exposure + 1.5*market_volatility + inventory_liquidity_risk

  Selection & ordering:
    • Consider only eligible models.
    • Sort by total_risk_score ascending.
    • Take top 5; assign rank = 1..5 in that order.

  Output (CSV → /workdir/sol.csv; exact header & order):
    make,model,year,avg_price,depreciation_risk,financing_exposure,market_volatility,inventory_liquidity_risk,total_risk_score,rank

  Formatting:
    year:int; avg_price:2dp; depreciation_risk:3dp; financing_exposure:2dp; 
    market_volatility:2dp; inventory_liquidity_risk:2dp; total_risk_score:3dp; rank:1..5
    Exactly 5 rows. No extra columns. No index.
metadata:
  difficulty: hard
  category: "data analytics"
  tags: ["data-analysis","data-science","finance-risk", "market-volatility", "multi-constraint-filtering"]
